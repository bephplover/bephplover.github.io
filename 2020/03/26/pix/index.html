<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">pix | Cupid&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "Cupid'sblog";
  mashiro_option.author_name = "blog";
  mashiro_option.site_url = "https://bephplover.github.io/";
  mashiro_option.v_appId = "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz";
  mashiro_option.v_appKey = "mgOpfzbkHYqU92CV4IDlAUHQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(1).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(2).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(3).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(4).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(5).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(6).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(7).jpg.webp,https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/cover/(8).jpg.webp".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://bephplover.github.io/">
          <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/custom/namei.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>Welcome to my blog,have a good time!</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="https://github.com/bephplover" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="http://weibo.com/mashirozx?is_all=1" target="_blank" class="social-github" title="sina">
                    <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/social/sina.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://music.163.com/#/user/home?id=623980935" target="_blank" class="social-github" title="wangyiyun">
                    <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/social/wangyiyun.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="http://weibo.com/mashirozx?is_all=1" target="_blank" class="social-github" title="zhihu">
                    <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/social/zhihu.png">
                  </a>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">Cupid&#39;s</span>
            <span class="shironeko">blog</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/内网渗透/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          内网渗透
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/编程类/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          编程学习
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/Linux/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          Linux学习
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/CTF/">
                          <i class="fa fa-commenting-o" aria-hidden="true"></i>
                          CTF
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/Web漏洞/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          Web渗透
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/tags/悦读/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          书单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/图集/">
                          <i class="fa fa-photo" aria-hidden="true"></i>
                          图集
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/links/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
                    友人帐
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                      <li>
                        <a href="/theme-sakura/">
                          <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                          主题
                        </a>
                      </li>
                    
                      <li>
                        <a href="/lab/">
                          <i class="fa fa-cogs" aria-hidden="true"></i>
                          Lab
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/atom.xml">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
                    RSS
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
          <header class="entry-header">
            <h1 class="entry-title">pix</h1>
            <p class="entry-census">&nbsp;·&nbsp;2020-3-26&nbsp;·&nbsp;<span id="busuanzi_value_page_pv"></span>次阅读</p></p>

            <hr>
          </header>
        
        <div class="entry-content">
          <h1><span id="pix配置">PIX配置</span></h1><p>个人来说配置步骤如下:<br>1.使用nameif设置接口名称，并指定安全级别(设置之前需要使用interface设置接口)</p>
<p>int e0<br>nameif outside<br>    设置安全级别命令<br>    int e0<br>    security-level level<br>show interface//查看接口</p>
<p>接口的配置需要满足访问列表、状态检测、地址转换的要求，允许安全级高接口流向安全级低接口(内-&gt;外)，安全级低接口流向安全级高接口必须再经过额外的检测和过滤。<br>2.使用hostname使用pix主机名</p>
<p>3.使用ip address设置Ip</p>
<p>4.使用global指定公网地址范围:定义地址池</p>
<pre><code class="global">Global命令的配置语法：

global(if_name)nat_idip_address-ip_address[netmarkglobal_mask]

其中：

(if_name)：表示外网接口名称，一般为outside。

nat_id：建立的地址池标识(nat要引用)。

ip_address-ip_address：表示一段ip地址范围。

[netmarkglobal_mask]：表示全局ip地址的网络掩码。

例如：

PIX525(config)#global(outside) 1 133.0.0.1-133.0.0.15

地址池1对应的IP是：133.0.0.1-133.0.0.15

PIX525(config)#global(outside) 1 133.0.0.1

地址池1只有一个IP地址133.0.0.1。

PIX525(config)#noglobal(outside) 1 133.0.0.1

表示删除这个全局表项。</code></pre>
<p>5.nat<br>地址转换命令，将内网的私有地址ip转换为外网公网ip<br>nat命令配置语法：nat(if_name)nat_idlocal_ip[netmark]</p>
<p>6.route<br>route outside 0.0.0.0 0.0.0.0 192.168.0.1<br>route inside 10.0.1.0 255.255.255.0 10.0.102.1</p>
<p>下面是杂项命令配置(总结于使用中):<br>copy running-config tftp 是指把当前配置拷贝到TFTP服务器上<br>copy running-config startup-config 是指把当前配置写入NVRAM保存，覆盖当前的启动配置<br>write 把当前配置写入NVRAM保存，覆盖当前的启动配置<br>write network 是把当前配置写到TFTP服务器<br>write terminal是把当前配置输出到终端上，同show run</p>
<p>write和copy running-config startup-config结果一样<br>write network 和copy running-config tftp 结果一样</p>
<p>clear running-config  //清除运行时配置</p>
<p>write erase  //清除另一种配置</p>
<p>telnet:</p>
<p>conf t<br>line vty 0 4<br>password 输入的密码<br>enable password 输入的密码</p>
<p>inside        dmz           outside</p>
<p>38.0.2.0/24   39.0.2.0/24  40.0.2.0/24</p>
<p>PAT: port address translation</p>
<p>路由器查看ip：<br>show run int f0/0</p>
<p>quit  退出命令</p>
<p>nat con  //启用 nat</p>
<p>改变或删除一个nat命令语句后，使用clear xlate命令。</p>
<p>防火墙实验配置、查验方法<br>debug icmp trace<br>no debug icmp trace</p>
<p>logging on //打开日志<br>logging console 7<br>show user<br>who<br>show conn<br>show run nat-control<br>show xlate （detail） //可以显示翻译槽位的内容</p>
<p>路由器中可以使用debug ip icmp查看ping信息<br>路由器配置默认路由:<br>ip route 目的地址 子网掩码 下一跳</p>
<p>问题？<br>当防火墙有很多条nat,或者pat时候，规则应该按照什么顺序检验(第一个数据包很关键)</p>
<p>端口号尽量大于1023</p>
<p>global对应安全级别低的那端，local对应安全级别高的那端</p>
<p>UIO的含义是什么？<br>UIO都是TCP的连接标志值，分别代表:<br>-U:    up<br>-I：inbound data<br>-O: outbound data<br>也即三次握手完成，然后是接收到进站消息，接受到出站消息<br>允许outside的icmp 的echo-reply</p>
<p>xf(config)# nat (inside) 1 40.0.2.0 255.255.255.0<br>xf(config)# global (outside) 1 38.0.2.20-38.0.2.254 netmask 255.255.255.0<br>xf(config)# access-list outside permit icmp any any echo-reply  //创建ACL<br>xf(config)# access-group outside in interface outside  //把ACL绑定到防火墙的外部接口上</p>
<p>nat和global均为动态转换，有的时候需要静态转换,即地址不是转换到地址池的内容，每次都固定分配IP如下<br>• 静态转换将一个单个的本地地址映射为一个单个的全局地址<br>用于本地节点必须被公共空间(internet)访问时<br>本地节点10.10.10.9配置成一个全局地址192.168.0.9，static命令只 配置地址转换配<br>    PIX(config)# static (inside, outside) 192.168.0.9 10.10.10.9</p>
<p>TCP进站(Inbound)<br>同理TCP出站(outbound)</p>
<p>255.255.255.255这个地址一般用来广播的时候使用，而0.0.0.0这个地址可以代表这是一个还没有分配 ip 的主机。</p>
<p>不过0.0.0.0还有其他作用，代表主机还没有分配ip地址只是其中的一个用处。例如：充当默认路由来使用，当一个路由器要发送路由表中无法查询的包时，如果设置了全零网络的路由时，我们就可以把这个包丢给全零网络的路由。<br>小结:<br>配置防火墙永远把握一个原则：访问由低到高需要做静态映射（dnat，也叫发布服务器）；访问从高安全级到低安全级需要做nat转换（snat，如访问外网），access-group dmz_access_in in interface dmz在接口上应用acl，来控制ip之间的访问。</p>
<p>实验三:<br>目的：<br>１、内网中的指定用户（如40.0.2.1）可以防问Internet和DMZ中的WEB服务器（如39.0.2.1）。并且内网所有用户都可访问dmz区域服务器。<br>２、外网的用户可以防问DMZ区的Web平台（39.0.2.1）。<br>３、DMZ区的WEB服务器可以防问内网中的SQL数据库服务器和外网中的其它服务器。<br>用到的关键词：NAT、PAT、端口重定向、ACL和route功能。</p>
<pre><code>目的2:
static (dmz,outside) 38.0.2.1 39.0.2.1 netmask 255.255.255.255
上面static语句错误，outside地址要填没有被占用的地址才行，不然就是Deny IP due to Land Attack from 38.0.2.1 to 38.0.2.1
因而改为:static (dmz,outside) 38.0.2.10 39.0.2.1 netmask 255.255.255.255
dmz成功ping通outside
dns: 
access-list 101 extended permit tcp any interface outside eq www
access-group 101 in interface outside</code></pre><p>access-group命令详解<br>使用access-group在一个接口上只能绑定一个ACL,因而需要使用不同的acl_id来进行增添acl,而不能写多条,可以使用extended。</p>
<pre><code class="acl-group">    accesg-group acl_ ID in interface interface_ name
    要完成outside对于DMZ的流量入站需要完成三个步骤:
        1.可以访问到服务器      Configure static translation for web server address
        2.默认拒绝   Configure inbound ACL
        3.绑定接口。 Apply ACL to outside interface
不允许低于1024端口的访问192.168.0.1
access-list DMZ1 deny tcp 192.168.1.0 255.255.255.0 host 192.168.0.1 lt 1024

outside无法ping通dmz
日志显示:No translation group found for icmp src outside
</code></pre>
<p>NAT:<br>    NAT选择顺序</p>
<p>根据对防火墙性能资源消耗占有程度来选择：</p>
<p>NAT exemptions (nat 0 access-list commands) 带ACL的nat 0</p>
<p>Policy NAT (static access-list commands)</p>
<p>Static NAT (static commands without port numbers)</p>
<p>Static PAT (static commands with port numbers)</p>
<p>NAT 0 or Policy NAT (nat nat_id access-list commands)</p>
<p>Dynamic NAT and PAT (nat nat_id commands)</p>
<p>如果处于同一级别就需要比较访问控制列表的明细程度和网段地址的明细程度，如果前面都一样则写在前面的优先</p>
<h1><span id="pix-logging-config">PIX-Logging-config</span></h1><p>从防火墙日志可以得到什么？<br>防火墙规则允许的连接:浏览这些消息可以帮助发现遗留在安全策略中的漏洞。<br>防火墙规则拒绝的连接:可以了解到什么类型的活动直接正针对着安全内部网络。<br>拒绝规则等级:使用ACE的拒绝等级日志功能可以显示正在对防火墙所发生的攻击。<br>用户活动:防火墙的用户验证和命令使用均可被记录，为安全政策的变更提供审计线索</p>
<pre><code class="logging-命令">logging host
logging trap
logging buffered
logging console
logging facility
logging monitor
logging timestamps
(no) logging message
show logging
clear logging</code></pre>
<p>实验4防火墙命令配置</p>
<pre><code class="pix">conf t
logging on
配置时钟:
clock timezone UTC -8
clock set hh:mm:ss {day month | month day} year
show clock
logging timestamp
logging host inside 40.0.2.10

其中logging console会降低PIX防火墙的处理性能
logging monitor可能会导致Telnet会话丢失
logging standby会造成两倍的数据流量</code></pre>
<p>对象分组的作用:<br>随着客户端、服务器数量以及服务种类的增加,ACL的数量也随之增加，这样会使整个处理过程变得费力并且难于管理。<br>解决:PIX防火墙的对象分组特性就是为了减少ACL创建和维护的复杂性，提高易管理性而设计的。</p>
<p>对象分组的类型:<br>协议对象、网络对象、服务对象、ICMP类型对象</p>
<pre><code class="对象分组">网络:
object-group netword Inside_Eng
network-object host 10.0.0.1
network-object host 10.0.0.1
服务:
object-group netword Inside_Eng
port-object eq http
port-object eq https
port-object eq ftp

ICMP：
icmp-object echo
icmp-object echo-reply</code></pre>
<p>日志的输出形式:<br>PIX防火墙的telnet对话，或者是防火墙内部缓冲区、系统日志服务器、本设备控制台</p>
<p>AAA:<br>认证（Authentication）、授权（Authorization）和审计（Accounting）<br>核查顺序是:认证——&gt;授权—&gt;审计<br>如果没有认证的用户是没法授权和审计的。</p>
<p>作业:</p>
<pre><code class="homework">假定AAA服务器的IP地址为:10.0.0.10
nat (inside) 10.0.0.0 255.255.255.0
global (outside) 172.26.26.51-172.26.26.254 netmask 255.255.255.0

aaa-server MYTACACS protocal tacacs+
aaa-server MYTACACS (inside) host 10.0.0.10
key xf123
access-list outbound permit tcp any any eq telnet
access-list outbound permit tcp any any eq http
access-list outbound permit tcp any any eq https
aaa authentication match outbound inside MYTACACS 
aaa authentication exclude https inside 10.0.0.42 255.255.255.0 172.26.26.50 255.255.255.0 MYTACACS
aaa authentication exclude http inside 10.0.0.42 255.255.255.0 172.26.26.50 255.255.255.0 MYTACACS
aaa authentication exclude telnet inside 10.0.0.42 255.255.255.0 172.26.26.50 255.255.255.0 MYTACACS
</code></pre>
<p>虚拟防火墙：<br>实验前先检查自己的PIX镜像支持几个context</p>
<p>计算不同设备的PC值，并重新选择最大的，能最有效的降低CPU的利用率。<br>只允许admin进行管理和删除，物理防火墙只是容器不需要配置IP,分别IP需要 其他context设置</p>
<p>只有admin才可以changeto</p>
<p>failover配置实验中先配置primary<br>再配置secondary</p>
<p>查看vlan： do show vlan-switch brief</p>
<pre><code>Deny inbound icmp src outside:38.0.2.1 dst outside:38.0.2.187 (type 0, code 0)

解决办法:same-security-traffic permit intra-interface</code></pre><p>配置故障倒换A/A模式</p>
<p>故障倒换是用来做什么的？</p>
<p>what dose the Failover do?</p>
<p>个人理解是当防火墙出现故障时，能够有另一台备用机器仍然可以正常的维护设备的安全。这两个设备可以分别成为主副设备，主(primary),副||次||备用(Secondary).<br>当然这个另一台也可以通过虚拟防火墙的context实现。</p>
<p>那么什么情况下会触发故障倒换原因:<br>1.防火墙IPX防火墙电源关闭<br>2.活动PIX防火墙重启<br>3.活动PIX防火墙的一条链路关闭超过两个故障倒换轮询周期(缺省总时间为30S)<br>4.使用no failover active 命令，强制活动防火墙进行故障倒换；或者在待机防火墙上使用命令failover active,强制待机防火墙进行故障倒换<br>5.在活动PIX防火墙上，快内存被耗尽的状态持续超过15S</p>
<p>接下来看一下它究竟有哪几种模式：<br>A / S   active / standby<br>该模式下，有两台防火墙，其中一台为Primary,另一台为Secondary<br>当Pri的状态由Active-&gt;Failed,此时Sec就由Standby-&gt;Active</p>
<p>A / A   active / active<br>该模式下任然需要2台防火墙，但配置会更复杂，由于还需要在两台防火墙少至少启用两个虚拟防火墙，并对内部的流量进行区分。在每个context下都有自己的active和standby.所以需要配置每个设备下的context。</p>
<p>故障倒换的要求:故障恢复对其中的两个设备必须完全相同，这很好理解，不相同达不到相同的效果。</p>
<p>具体条件就不一一说明了。</p>
<pre><code class="交换机配置命令">
使用交换机前使用vlan database
添加需要的vlan
例如添加vlan 10
vlan 10即可
配置为中继trunk
sw mode trunk
#sw trunk encap dot1q（在cisco packet tracer中可不敲）
sw trunk allow vlan all
设置access接口
int f0/1
sw mode access
sw access vlan 10
#下面两句可敲可不敲
speed 100
duplex full</code></pre>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7null"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7null"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2020/04/04/no-num-str-webshell/" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                no-num_str_webshell</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2020/03/23/BJDCTF2020-2/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/tperch/jsd/img/20200510151324.png" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/tperch/jsd/img/20200510151324.png">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                BJDCTF2020-2</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz",
        appKey: "mgOpfzbkHYqU92CV4IDlAUHQ",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <a href="" class="profile gravatar"><img src="" itemprop="image" alt="" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author"></a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Cupid<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2018</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/bephplover/cdn@2.7/img/custom/namei.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">Cupid'sblog</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="https://github.com/bephplover" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
        <a href="https://wpa.qq.com/msgrd?v=3&uin=782377128&site=qq&menu=yes" class="fa fa-qq" target="_blank" style="color: #25c6fe; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/内网渗透/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  内网渗透
                </a>
              </li>
            
              <li>
                <a href="/categories/编程类/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  编程学习
                </a>
              </li>
            
              <li>
                <a href="/categories/Linux/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  Linux学习
                </a>
              </li>
            
              <li>
                <a href="/categories/CTF/">
                  <i class="fa fa-commenting-o" aria-hidden="true"></i>
                  CTF
                </a>
              </li>
            
              <li>
                <a href="/categories/Web漏洞/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  Web渗透
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/tags/悦读/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  书单
                </a>
              </li>
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/tags/图集/">
                  <i class="fa fa-photo" aria-hidden="true"></i>
                  图集
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/links/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
            友人帐
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
              <li>
                <a href="/theme-sakura/">
                  <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                  主题
                </a>
              </li>
            
              <li>
                <a href="/lab/">
                  <i class="fa fa-cogs" aria-hidden="true"></i>
                  Lab
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/atom.xml">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
            RSS
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="2660651585"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>